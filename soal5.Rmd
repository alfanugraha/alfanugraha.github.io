---
title: "Soal 5"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(reshape)
library(DT)
```

Akan dibuat tiga gambar visualisasi dari data IPM 2010-2018 untuk seluruh kabupaten/kota di provinsi di Indonesia. Data yang akan digunakan pada proses kali ini berisi nilai IPM, Harapan Lama Sekolah (HLS/EYS), dan Rataan Lama Sekolah (RLS/MYS). Fungsi yang digunakan diambil dari package `dplyr`, `reshape`, kemudian visualisasi secara interaktif menggunakan `shiny`.

### Praproses data

Tahap pertama adalah melakukan perubahan struktur data yang diberikan menggunakan pivot berdasarkan komponen. Dapat dilihat cuplikan data tersebut di bawah ini

```{r}
ipmdata <- read.table('ipm_metode_comb2.csv', header = T, sep = ";")
colnames(ipmdata)[5:13] <- c(2010:2018)
datatable(ipmdata)
```
Kemudian agar proses visualisasi menjadi mudah dengan data yang lebih spesifik maka dilakukan filter untuk memilih komponen dan provinsi yang akan ditambilkan  

```{r,render=F, results='hold'}
# pilih data berdasarkan komponen
ipmfilter <- ipmdata %>% filter(Komponen == "IPM" & Provinsi == "ACEH") %>% dplyr::select(-Komponen, -Provinsi)
ipmfilter <- ipmfilter[2:nrow(ipmfilter), ]

# membuat kategori dari data terpilih 
ipmselected <- ipmfilter %>% melt(id=c("Kode","KabKota")) %>% mutate(kategori=ifelse(value > 80, "IPM Sangat Tinggi", ifelse(value > 70, "IPM Tinggi", "IPM Sedang")))

# pilih data berdasarkan tahun
tahun <- 2010
ipmtahun <- ipmselected %>% filter(variable == 2010) %>% arrange(desc(value))
ipmtahun$value <- as.numeric(ipmtahun$value)
```

### Plot menggunakan `plotly`

Pada tahap visualisasi digunakan package `plotly` yang memiliki berbagai macam fitur interaktif plot. Grafik batang secara horizontal digunakan pada proses ini. Berikut potongan kodenya 

```{r, render=F, results='hold', eval=FALSE}
plot_ly(x = ~ipmtahun$value, y = ~reorder(ipmtahun$KabKota, tahun), color = ipmtahun$kategori, type = 'bar', orientation = 'h') %>% 
  layout(xaxis = list(range = c(55,83))) %>%
  layout(title = 'Index Pembangunan Manusia Kabupaten X Tahun Y',
                 xaxis = list(title = ''),
                 yaxis = list(title = ''),
                 legend = list(x = 0.729, y = 0.138,font = list(size = 10)),
                 margin = list(l = 100, r = 20, t = 70, b = 70),
                 paper_bgcolor = 'rgb(248, 248, 255)',
                 plot_bgcolor = 'rgb(248, 248, 255)')
```


### Visualisasi interaktif menggunakan Shiny

Seluruh proses di atas merupakan potongan kodenya saja. Dokumen interaktif yang dihasilkan menggunakan kode terpisah yang dapat diakses pada alamat <https://github.com/alfanugraha/alfanugraha.github.io/blob/master/soal5/app.R>. Script tersebut dibangun menggunakan package `shiny` sebagai salah satu R package yang digunakan untuk membangun aplikasi web interaktif.

Aplikasi web yang sudah dibangun dapat dilihat di bawah ini. Terdapat tiga grafik yang digunakan untuk menggambarkan indeks pembangunan, harapan lama sekolah, dan rataan lama sekolah. Dengan Shiny, dapat dengan mudah dianalisis, kabupaten/kota mana yang memilih nilai yang tinggi maupun sedang berdasarkan standar nasional 

```{r out.width="120%"}
knitr::include_app("https://alfanugraha.shinyapps.io/soal5/", height = "1300px")
```

